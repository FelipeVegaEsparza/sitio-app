---
import { getFullImageUrl } from '../../../utils/api';

interface Props {
  basicData: any;
  socialNetworks: any;
}

const { basicData, socialNetworks } = Astro.props;

const siteLogoFooter = basicData?.logoUrl ? getFullImageUrl(basicData.logoUrl) : '';

const iconMap: Record<string, string> = {
  'facebook': 'fa-facebook-f', 'instagram': 'fa-instagram', 'twitter': 'fa-twitter',
  'x': 'fa-x-twitter', 'youtube': 'fa-youtube', 'tiktok': 'fa-tiktok',
  'whatsapp': 'fa-whatsapp', 'telegram': 'fa-telegram', 'linkedin': 'fa-linkedin',
  'spotify': 'fa-spotify', 'soundcloud': 'fa-soundcloud',
};

function getIconClass(network: string): string {
  return iconMap[network.toLowerCase()] || `fa-${network.toLowerCase()}`;
}

const socialLinks = socialNetworks ? Object.entries(socialNetworks)
    .filter(([network, url]) => {
        if (network === 'createdAt' || network === 'updatedAt') return false;
        return network && url && typeof url === 'string' && url.trim() !== '';
    })
    .map(([network, url]) => {
        const link = network === 'whatsapp' ? `https://wa.me/${(url as string).replace(/\+/g, '')}` : url as string;
        const iconClass = getIconClass(network);
        const fullIconClass = `fa-brands ${iconClass}`;
        return { network, link, fullIconClass };
    }) : [];
---
<footer class="t3-footer">
    <div class="t3-logo">
        {siteLogoFooter && <a href="/"><img src={siteLogoFooter} alt="Logo"></a>}
    </div>
    {socialLinks.length > 0 && (
        <div class="t3-socials">
            {socialLinks.map(({ network, link, fullIconClass }) => (
                <a href={link} target="_blank" rel="noopener noreferrer" title={network} aria-label={network}>
                    <i class={fullIconClass}></i>
                </a>
            ))}
        </div>
    )}
</footer>

<style>
    .t3-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 2rem;
        background-color: #fff;
        border-top: 1px solid #dee2e6;
        margin-top: 2rem;
    }
    .t3-logo img {
        height: 40px;
        width: auto;
    }
    .t3-socials {
        display: flex;
        gap: 1rem;
    }
    .t3-socials a {
        color: #6c757d;
        font-size: 1.2rem;
        transition: color 0.3s ease;
    }
    .t3-socials a:hover {
        color: #0d6efd;
    }
</style>
